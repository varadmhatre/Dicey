<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Noir-Store PDP</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <main class="shell grid grid-2" id="root"></main>
  <script src="./app.js"></script>
  <script>
    const root = document.getElementById('root');
    const slug = new URLSearchParams(location.search).get('slug') || 'loose-fit-hoodie';
    const product = NoirStore.readProducts().find(p => p.slug === slug);

    if (!product) {
      root.innerHTML = '<p>Product not found.</p>';
    } else {
      const reviews = product.reviews.length
        ? product.reviews.map(r => `<article class="card"><strong>${r.author}</strong><div class="small">${r.rating}/5</div><p>${r.body}</p></article>`).join('')
        : '<p class="small">No reviews yet.</p>';

      root.innerHTML = `
        <section>
          <img class="hero" src="${product.images[0]}" alt="${product.title}" />
          <div class="gallery">${product.images.slice(0,4).map(src => `<img src="${src}" alt="${product.title}" />`).join('')}</div>
        </section>
        <section>
          <p class="small">${product.category}</p>
          <h1>${product.title}</h1>
          <h2>$${(product.price/100).toFixed(2)}</h2>
          <p class="small">${product.description}</p>
          <div style="display:flex; gap:10px; margin:14px 0 26px;">
            <button class="btn secondary">Add to Cart</button>
            <a class="btn" href="${product.redirect_url}" target="_blank" rel="noopener noreferrer sponsored">Buy Now on Amazon</a>
          </div>
          <h3>Recent Reviews</h3>
          <div class="grid">${reviews}</div>
        </section>
      `;
    }
  </script>
</body>
</html>
